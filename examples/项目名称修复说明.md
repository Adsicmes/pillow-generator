# 项目名称显示问题修复

## 问题描述

保存了项目文件并重命名后，生成的Pillow代码函数注释中仍然显示"未命名项目"。

## 问题原因

在之前的版本中，当保存和打开项目文件时，程序没有正确更新项目模型中的项目名称。项目名称一直保持为默认的"未命名项目"，因此在代码生成时，函数注释中会显示这个默认名称。

## 修复方案

我已经修复了 `src/ui/main_window.py` 文件中的两个关键方法：

### 1. 保存项目时更新项目名称

在 `save_project_as()` 方法中：
```python
# 更新项目名称为文件名（去掉扩展名）
project_name = os.path.splitext(os.path.basename(file_path))[0]
self.project_model.project_name = project_name
```

### 2. 打开项目时确保项目名称正确

在 `open_project()` 方法中：
```python
# 确保项目名称与文件名一致
project_name = os.path.splitext(os.path.basename(file_path))[0]
self.project_model.project_name = project_name
```

## 修复效果

现在当您：

1. **保存项目文件**（另存为）时：
   - 项目名称会自动更新为文件名（去掉.pgp扩展名）
   - 生成的代码函数注释会显示正确的项目名称

2. **打开项目文件**时：
   - 项目名称会确保与文件名一致
   - 即使文件中保存的是旧的项目名称，也会被文件名覆盖

3. **生成代码**时：
   - 函数注释中会显示：`生成图像 - [您的项目文件名]`
   - 而不再是：`生成图像 - 未命名项目`

## 测试步骤

1. 启动程序
2. 创建一个简单的项目（添加文字层或设置底图）
3. 点击"文件" → "另存为"，保存为 `my_project.pgp`
4. 生成代码，查看函数注释是否显示：`生成图像 - my_project`
5. 关闭程序，重新打开该项目文件
6. 再次生成代码，确认项目名称仍然正确

## 相关文件

- `src/ui/main_window.py` - 主要修复位置
- `src/ui/code_generator.py` - 第200行使用项目名称生成注释
- `src/core/project_manager.py` - 项目文件保存和加载逻辑

现在这个问题应该已经完全解决了！🎉
